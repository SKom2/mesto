(()=>{"use strict";class e{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}_showError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),t.classList.add(this._config.errorClass),t.textContent=e.validationMessage}_hideError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}setButtonState(){this._toggleButtonState()}setInputValidity(){this._inputList.forEach((e=>{this._checkInputValidity(e)}))}setState(){this._toggleButtonState(),this.setInputValidity()}enableValidation(){this._setEventListeners()}}const t=document.querySelector("#button_edit"),s=document.querySelector("#button_add"),i=document.querySelector(".profile__edit-avatar"),n=document.querySelector("#cardsAddForm"),r=document.querySelector("#profileEditForm"),o=document.querySelector("#avatarEditForm"),a={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_visible"};class l{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton=this._popup.querySelector(".popup__close"),this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target===this._popup&&this.close()}))}}class c extends l{constructor(e,{callBack:t}){super(e),this._callBack=t,this._formElement=this._popup.querySelector(".form"),this._inputList=this._popup.querySelectorAll(".form__input"),this._button=this._popup.querySelector(".form__button"),this.setEventListeners()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}changeButtonState(e,t,s){this._button.textContent=e?s:t}close(){super.close(),this._formElement.reset()}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._getInputValues())}))}}class h{constructor(e,t,{handleCardClick:s,handleLikeClick:i,handleDeleteButtonClick:n},r){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=s,this._handleLikeClick=i,this._handleDeleteButtonClick=n,this._cardId=e._id,this._userId=r,this._ownerId=e.owner._id,this._likes=e.likes,this._isLiked=this._isCardLiked()}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_setData(){this._cardImage=this._element.querySelector(".card__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName=this._element.querySelector(".card__title"),this._cardName.textContent=this._name}_isCardLiked(){let e=!1;return this._likes.forEach((t=>{t._id===this._userId&&(e=!0)})),e}_likeCard(){this._handleLikeClick("PUT",this._cardId)}_unlikeCard(){this._handleLikeClick("DELETE",this._cardId)}_toggleLike(){this._isLiked?this._unlikeCard():this._likeCard()}updateLikes(e){this._likeCounter=this._element.querySelector(".card__like-counter"),this._cardLike=this._element.querySelector(".card__like");let t=!1;e.forEach((e=>{e._id===this._userId&&(t=!0)})),this._isLiked=t,this._isLiked?(this._cardLike.classList.add("card__like_active"),this._isLiked=!0):(this._cardLike.classList.remove("card__like_active"),this._isLiked=!1),this._likeCounter.textContent=e.length}_setEventListeners(){this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButtonClick(this._cardId,this)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})})),this._cardLike=this._element.querySelector(".card__like"),this._cardLike.addEventListener("click",(()=>{this._toggleLike()}))}removeCard(){this._element.remove()}generateCard(){return this._element=this._getTemplate(),this.updateLikes(this._likes),this._deleteButton=this._element.querySelector(".card__delete"),this._isLiked&&this._cardLike.classList.add("card__like_active"),this._userId!==this._ownerId&&this._deleteButton.remove(),this._setData(),this._setEventListeners(),this._element}}const _=new class{constructor(e){this._config=e}_getResponseData(e){return e.ok?e.json():Promise.reject(new Error(`Ошибка: ${e.status}`))}getProfile(){return fetch(`${this._config.url}/users/me`,{headers:this._config.headers}).then((e=>this._getResponseData(e)))}getCards(){return fetch(`${this._config.url}/cards`,{headers:this._config.headers}).then((e=>this._getResponseData(e)))}editProfile(e){return fetch(`${this._config.url}/users/me`,{method:"PATCH",headers:this._config.headers,body:JSON.stringify({name:e.name,about:e.about})}).then((e=>this._getResponseData(e)))}addCard(e){return fetch(`${this._config.url}/cards`,{method:"POST",headers:this._config.headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>this._getResponseData(e)))}handleControlLikes(e,t){return fetch(`${this._config.url}/cards/${t}/likes`,{method:e,headers:this._config.headers}).then((e=>this._getResponseData(e)))}deleteCard(e){return fetch(`${this._config.url}/cards/${e}`,{method:"DELETE",headers:this._config.headers}).then((e=>this._getResponseData(e)))}editAvatar(e){return fetch(`${this._config.url}/users/me/avatar`,{method:"PATCH",headers:this._config.headers,body:JSON.stringify({avatar:e})}).then((e=>this._getResponseData(e)))}}({url:"https://nomoreparties.co/v1/cohort-60",headers:{authorization:"0823f3d8-cee4-4f0b-9f88-c1dcbe025215","Content-Type":"application/json"}}),d=new class{constructor({nameSelector:e,aboutUserSelector:t,userSelector:s}){this._name=document.querySelector(e),this._aboutUser=document.querySelector(t),this._userAvatar=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._aboutUser.textContent}}setUserInfo(e){this._name.textContent=e.name,this._aboutUser.textContent=e.about,this._userAvatar.src=e.avatar,this._userId=e._id}getUserId(){return this._userId}}({nameSelector:".profile__title",aboutUserSelector:".profile__subtitle",userSelector:".profile__avatar"});Promise.all([_.getProfile(),_.getCards()]).then((([e,t])=>{d.setUserInfo(e),p.renderItems(t)})).catch((e=>console.log(`Ошибка: ${e}`)));const u=e=>{const t=new h(e,"#card-template",{handleCardClick:e=>{m.open(e)},handleLikeClick:(e,s)=>{_.handleControlLikes(e,s).then((e=>{t.updateLikes(e.likes)})).catch((e=>console.log(`Ошибка: ${e}`)))},handleDeleteButtonClick:(e,t)=>{f.open(e,t)}},d.getUserId());return t.generateCard()},p=new class{constructor({renderer:e},t){this._renderer=e,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}}({renderer:e=>{p.addItem(u(e))}},".places"),m=new class extends l{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._title=this._popup.querySelector(".popup__title"),this.setEventListeners()}open(e){super.open(),this._image.src=e.link,this._image.alt=e.name,this._title.textContent=e.name}}("#popup_photo"),k=new c("#popup_add",{callBack:e=>{k.changeButtonState(!0,"Создать","Создание..."),_.addCard(e).then((e=>{p.addItem(u(e))})).then((()=>k.close())).catch((e=>console.log(`Ошибка: ${e}`))).finally((()=>k.changeButtonState(!1,"Создать","Создание...")))}}),g=new c("#popup_edit",{callBack:e=>{g.changeButtonState(!0,"Сохранить","Сохранение..."),_.editProfile(e).then((e=>{d.setUserInfo(e)})).then((()=>g.close())).catch((e=>console.log(`Ошибка: ${e}`))).finally((()=>g.changeButtonState(!1,"Сохранить","Сохранение...")))}}),f=new class extends l{constructor(e,{callBack:t}){super(e),this._callBack=t,this._formElement=this._popup.querySelector(".form"),this._button=this._popup.querySelector(".form__button"),this.setEventListeners()}open(e,t){super.open(),this._cardId=e,this._element=t}changeButtonState(e,t,s){this._button.textContent=e?s:t}setEventListeners(){super.setEventListeners(),this._button.addEventListener("click",(e=>{e.preventDefault(),this._callBack(this._cardId,this._element)}))}}("#popup_delete-card",{callBack:(e,t)=>{f.changeButtonState(!0,"Да","Удаление..."),_.deleteCard(e).then((()=>{t.removeCard()})).then((()=>f.close())).catch((e=>console.log(`Ошибка: ${e}`))).finally((()=>f.changeButtonState(!1,"Да","Удаление...")))}}),L=new c("#popup_edit-avatar",{callBack:e=>{L.changeButtonState(!0,"Сохранить","Сохранение..."),_.editAvatar(e.link).then((e=>{d.setUserInfo(e)})).then((()=>L.close())).catch((e=>console.log(`Ошибка: ${e}`))).finally((()=>L.changeButtonState(!1,"Сохранить","Сохранение...")))}}),E=new e(a,n),S=new e(a,r),v=new e(a,o);t.addEventListener("click",(()=>{const e=d.getUserInfo();g.setInputValues(e),g.open(),S.setState()})),s.addEventListener("click",(()=>{k.open(),E.setButtonState()})),i.addEventListener("click",(()=>{L.open(),v.setButtonState()})),v.enableValidation(),S.enableValidation(),E.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQXNCcEksT0FDdEJ3SSxFQUFzQnpKLGdCQUFnQixJQUcxQ08sRUFBYVIsaUJBQWlCLFNBQVMsS0FDbkN5SixFQUF3QnZJLE9BQ3hCMEksRUFBd0IzSixnQkFBZ0IsSUFJNUMySixFQUF3QnhKLG1CQUN4QnVKLEVBQXlCdkosbUJBQ3pCc0osRUFBc0J0SixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQpe1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIF9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KXtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KXtcclxuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKXtcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpe1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCl7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHNldEJ1dHRvblN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKClcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbnB1dFZhbGlkaXR5KCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHNldFN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKClcclxuICAgICAgICB0aGlzLnNldElucHV0VmFsaWRpdHkoKTtcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH07XHJcbn0iLCJleHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnV0dG9uX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHBob3RvQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2J1dHRvbl9hZGQnKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWF2YXRhcicpXHJcbmV4cG9ydCBjb25zdCBjYXJkc0FkZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZHNBZGRGb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZUVkaXRGb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdmF0YXJFZGl0Rm9ybScpO1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICAgIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faW5wdXQnLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcuZm9ybV9fYnV0dG9uJyxcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdmb3JtX19idXR0b25faW5hY3RpdmUnLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiAnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgICBlcnJvckNsYXNzOiAnZm9ybV9faW5wdXQtZXJyb3JfdmlzaWJsZSdcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgICB1cmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYwJyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnMDgyM2YzZDgtY2VlNC00ZjBiLTlmODgtYzFkY2JlMDI1MjE1JyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJyl7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmKGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge1BvcHVwfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7Y2FsbEJhY2t9KSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fY2FsbEJhY2sgPSBjYWxsQmFjaztcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX2lucHV0Jyk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm1fX2J1dHRvbicpO1xyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKXtcclxuICAgICAgICBjb25zdCBmb3JtRGF0YSA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBmb3JtRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiBmb3JtRGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbnB1dFZhbHVlcyhpbnB1dFZhbHVlcykge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZUJ1dHRvblN0YXRlKGlzTG9hZCwgY3VycmVudFN0YXRlLCBsb2FkaW5nU3RhdGUpIHtcclxuICAgICAgICBpZiAoaXNMb2FkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdTdGF0ZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IGN1cnJlbnRTdGF0ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5fY2FsbEJhY2sodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCB7aGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2xpY2ssIGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrfSwgdXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sgPSBoYW5kbGVEZWxldGVCdXR0b25DbGljaztcclxuICAgICAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgICAgICB0aGlzLl9pc0xpa2VkID0gdGhpcy5faXNDYXJkTGlrZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxyXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldERhdGEoKSB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJylcclxuICAgICAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgX2lzQ2FyZExpa2VkKCkge1xyXG4gICAgICAgIGxldCBpc0xpa2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgaXNMaWtlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBpc0xpa2VkO1xyXG4gICAgfVxyXG5cclxuICAgIF9saWtlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soJ1BVVCcsIHRoaXMuX2NhcmRJZClcclxuICAgIH1cclxuXHJcbiAgICBfdW5saWtlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soJ0RFTEVURScsIHRoaXMuX2NhcmRJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3RvZ2dsZUxpa2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzTGlrZWQpe1xyXG4gICAgICAgICAgICB0aGlzLl91bmxpa2VDYXJkKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUNhcmQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlTGlrZXMobGlrZXMpIHtcclxuICAgICAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnRlcicpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZScpO1xyXG5cclxuICAgICAgICBsZXQgaXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgICAgIGxpa2VzLmZvckVhY2goKGxpa2UpID0+IHtcclxuICAgICAgICAgICAgaWYgKGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FyZExpa2UuY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZV9hY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FyZExpa2UuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZV9hY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5faXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b25DbGljayh0aGlzLl9jYXJkSWQsIHRoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuX2NhcmRMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZScpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl90b2dnbGVMaWtlKClcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVMaWtlcyh0aGlzLl9saWtlcylcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUnKTtcclxuICAgICAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jYXJkTGlrZS5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlX2FjdGl2ZScpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zZXREYXRhKCk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge0Zvcm1WYWxpZGF0b3J9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHtcclxuICAgIGFwaUNvbmZpZyxcclxuICAgIGF2YXRhckJ1dHRvbixcclxuICAgIGF2YXRhckVkaXRGb3JtLFxyXG4gICAgY2FyZHNBZGRGb3JtLFxyXG4gICAgcGhvdG9BZGRCdXR0b24sXHJcbiAgICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICAgIHByb2ZpbGVFZGl0Rm9ybSxcclxuICAgIHZhbGlkYXRpb25Db25maWdcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7QXBpfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHtQb3B1cFdpdGhJbWFnZX0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IHtQb3B1cFdpdGhGb3JtfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7UG9wdXBXaXRoQ29uZmlybWF0aW9ufSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IHtVc2VySW5mb30gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHtTZWN0aW9ufSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7Q2FyZH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xyXG5pbXBvcnQgJy4vaW5kZXguY3NzJ1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaShhcGlDb25maWcpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgbmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX3RpdGxlJyxcclxuICAgIGFib3V0VXNlclNlbGVjdG9yOiAnLnByb2ZpbGVfX3N1YnRpdGxlJyxcclxuICAgIHVzZXJTZWxlY3RvcjogJy5wcm9maWxlX19hdmF0YXInXHJcbn0pO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRQcm9maWxlKCksIGFwaS5nZXRDYXJkcygpXSlcclxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzRGF0YV0pID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICAgICAgY2FyZExpc3QucmVuZGVySXRlbXMoY2FyZHNEYXRhKTtcclxufSlcclxuICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCkpXHJcblxyXG5cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChpdGVtKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgJyNjYXJkLXRlbXBsYXRlJywge1xyXG4gICAgICAgIGhhbmRsZUNhcmRDbGljazogKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhbmRsZUxpa2VDbGljazogKHJlcXVlc3QsIGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgICBhcGkuaGFuZGxlQ29udHJvbExpa2VzKHJlcXVlc3QsIGNhcmRJZClcclxuICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYW5kbGVEZWxldGVCdXR0b25DbGljazogKGNhcmRJZCwgY2FyZCkgPT4ge1xyXG4gICAgICAgICAgICBwb3B1cFdpdGhEZWxldGlvbkNvbmZpcm1hdGlvbkZvcm0ub3BlbihjYXJkSWQsIGNhcmQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAgICAgdXNlckluZm8uZ2V0VXNlcklkKClcclxuICAgICk7XHJcbiAgICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbiAoe1xyXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgY2FyZExpc3QuYWRkSXRlbShyZW5kZXJDYXJkKGl0ZW0pKTtcclxuICAgIH1cclxuXHJcbn0sICcucGxhY2VzJyk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnI3BvcHVwX3Bob3RvJyk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhBZGRQaG90b0Zvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSgnI3BvcHVwX2FkZCcsIHtcclxuICAgIGNhbGxCYWNrOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgIHBvcHVwV2l0aEFkZFBob3RvRm9ybS5jaGFuZ2VCdXR0b25TdGF0ZSh0cnVlLCAn0KHQvtC30LTQsNGC0YwnLCAn0KHQvtC30LTQsNC90LjQtS4uLicpO1xyXG4gICAgICAgIGFwaS5hZGRDYXJkKGl0ZW0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0ocmVuZGVyQ2FyZChyZXMpKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gcG9wdXBXaXRoQWRkUGhvdG9Gb3JtLmNsb3NlKCkpXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCkpXHJcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwV2l0aEFkZFBob3RvRm9ybS5jaGFuZ2VCdXR0b25TdGF0ZShmYWxzZSwgJ9Ch0L7Qt9C00LDRgtGMJywgJ9Ch0L7Qt9C00LDQvdC40LUuLi4nKSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cF9lZGl0Jywge1xyXG4gICAgY2FsbEJhY2s6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtLmNoYW5nZUJ1dHRvblN0YXRlKHRydWUsICfQodC+0YXRgNCw0L3QuNGC0YwnLCAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcclxuICAgICAgICBhcGkuZWRpdFByb2ZpbGUoZGF0YSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtLmNsb3NlKCkpXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCkpXHJcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwV2l0aEVkaXRQcm9maWxlRm9ybS5jaGFuZ2VCdXR0b25TdGF0ZShmYWxzZSwgJ9Ch0L7RhdGA0LDQvdC40YLRjCcsICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpKVxyXG4gICAgfSxcclxufSk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhEZWxldGlvbkNvbmZpcm1hdGlvbkZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcjcG9wdXBfZGVsZXRlLWNhcmQnLCB7XHJcbiAgICBjYWxsQmFjazogKGNhcmRJZCwgY2FyZCkgPT4ge1xyXG4gICAgICAgIHBvcHVwV2l0aERlbGV0aW9uQ29uZmlybWF0aW9uRm9ybS5jaGFuZ2VCdXR0b25TdGF0ZSh0cnVlLCAn0JTQsCcsICfQo9C00LDQu9C10L3QuNC1Li4uJylcclxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiBwb3B1cFdpdGhEZWxldGlvbkNvbmZpcm1hdGlvbkZvcm0uY2xvc2UoKSlcclxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKSlcclxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gcG9wdXBXaXRoRGVsZXRpb25Db25maXJtYXRpb25Gb3JtLmNoYW5nZUJ1dHRvblN0YXRlKGZhbHNlLCAn0JTQsCcsICfQo9C00LDQu9C10L3QuNC1Li4uJykpXHJcbiAgICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEVkaXRBdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cF9lZGl0LWF2YXRhcicsIHtcclxuICAgIGNhbGxCYWNrOiAoZGF0YSkgPT4ge1xyXG4gICAgICAgIHBvcHVwV2l0aEVkaXRBdmF0YXJGb3JtLmNoYW5nZUJ1dHRvblN0YXRlKHRydWUsICfQodC+0YXRgNCw0L3QuNGC0YwnLCAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKVxyXG4gICAgICAgIGFwaS5lZGl0QXZhdGFyKGRhdGEubGluaylcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiBwb3B1cFdpdGhFZGl0QXZhdGFyRm9ybS5jbG9zZSgpKVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApKVxyXG4gICAgICAgICAgICAuZmluYWxseSgoKSA9PiBwb3B1cFdpdGhFZGl0QXZhdGFyRm9ybS5jaGFuZ2VCdXR0b25TdGF0ZShmYWxzZSwgJ9Ch0L7RhdGA0LDQvdC40YLRjCcsICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpKVxyXG4gICAgfSxcclxufSlcclxuXHJcbmNvbnN0IGNhcmRzQWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGNhcmRzQWRkRm9ybSk7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIHByb2ZpbGVFZGl0Rm9ybSk7XHJcbmNvbnN0IGVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgYXZhdGFyRWRpdEZvcm0pO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBwb3B1cFdpdGhFZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXMoaW5wdXRWYWx1ZXMpO1xyXG4gICAgcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtLm9wZW4oKTtcclxuICAgIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5zZXRTdGF0ZSgpO1xyXG59KTtcclxuXHJcbnBob3RvQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoQWRkUGhvdG9Gb3JtLm9wZW4oKTtcclxuICAgIGNhcmRzQWRkRm9ybVZhbGlkYXRvci5zZXRCdXR0b25TdGF0ZSgpO1xyXG59KVxyXG5cclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoRWRpdEF2YXRhckZvcm0ub3BlbigpO1xyXG4gICAgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3Iuc2V0QnV0dG9uU3RhdGUoKTtcclxufSlcclxuXHJcblxyXG5lZGl0QXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmNhcmRzQWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRSZXNwb25zZURhdGEocmVzKSB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRQcm9maWxlKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9jb25maWcudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2NvbmZpZy5oZWFkZXJzXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fY29uZmlnLnVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2NvbmZpZy5oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpXHJcbiAgICB9XHJcbiAgICBlZGl0UHJvZmlsZShkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2NvbmZpZy51cmx9L3VzZXJzL21lYCwgICAge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2NvbmZpZy5oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogZGF0YS5hYm91dFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKVxyXG4gICAgfVxyXG5cclxuICAgIGFkZENhcmQoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9jb25maWcudXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2NvbmZpZy5oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAgZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgbGluazogZGF0YS5saW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpXHJcbiAgICB9XHJcbiAgICBoYW5kbGVDb250cm9sTGlrZXMocmVxdWVzdCwgY2FyZElkKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fY29uZmlnLnVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IHJlcXVlc3QsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2NvbmZpZy5oZWFkZXJzLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKVxyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2NvbmZpZy51cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5fY29uZmlnLmhlYWRlcnMsXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpXHJcbiAgICB9XHJcblxyXG4gICAgZWRpdEF2YXRhcihsaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2NvbmZpZy51cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9jb25maWcuaGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBsaW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpXHJcbiAgICB9XHJcbn0iLCJcclxuXHJcbmV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRVc2VyU2VsZWN0b3IsIHVzZXJTZWxlY3RvciB9KSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hYm91dFVzZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0VXNlclNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvICgpIHtcclxuICAgICAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBhYm91dDogdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50IH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyAoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IGRhdGEuX2lkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcil7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcyhjYXJkcyl7XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihjYXJkKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtQb3B1cH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdGl0bGUnKTtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihkYXRhKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge1BvcHVwfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwe1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwge2NhbGxCYWNrfSkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2NhbGxCYWNrID0gY2FsbEJhY2s7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcuZm9ybScpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19idXR0b24nKTtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbiAgICBvcGVuKGNhcmRJZCwgZWxlbWVudCkge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9jYXJkSWQgPSBjYXJkSWQ7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlQnV0dG9uU3RhdGUoaXNMb2FkLCBjdXJyZW50U3RhdGUsIGxvYWRpbmdTdGF0ZSkge1xyXG4gICAgICAgIGlmIChpc0xvYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1N0YXRlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gY3VycmVudFN0YXRlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbGxCYWNrKHRoaXMuX2NhcmRJZCwgdGhpcy5fZWxlbWVudCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfc2hvd0Vycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRCdXR0b25TdGF0ZSIsInNldElucHV0VmFsaWRpdHkiLCJzZXRTdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicGhvdG9BZGRCdXR0b24iLCJhdmF0YXJCdXR0b24iLCJjYXJkc0FkZEZvcm0iLCJwcm9maWxlRWRpdEZvcm0iLCJhdmF0YXJFZGl0Rm9ybSIsInZhbGlkYXRpb25Db25maWciLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2Nsb3NlQnV0dG9uIiwidGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImNhbGxCYWNrIiwic3VwZXIiLCJfY2FsbEJhY2siLCJfYnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybURhdGEiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJjaGFuZ2VCdXR0b25TdGF0ZSIsImlzTG9hZCIsImN1cnJlbnRTdGF0ZSIsImxvYWRpbmdTdGF0ZSIsInJlc2V0IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b25DbGljayIsInVzZXJJZCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b25DbGljayIsIl9jYXJkSWQiLCJfaWQiLCJfdXNlcklkIiwiX293bmVySWQiLCJvd25lciIsIl9saWtlcyIsImxpa2VzIiwiX2lzTGlrZWQiLCJfaXNDYXJkTGlrZWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldERhdGEiLCJfY2FyZEltYWdlIiwiX2VsZW1lbnQiLCJzcmMiLCJhbHQiLCJfY2FyZE5hbWUiLCJpc0xpa2VkIiwibGlrZSIsIl9saWtlQ2FyZCIsIl91bmxpa2VDYXJkIiwiX3RvZ2dsZUxpa2UiLCJ1cGRhdGVMaWtlcyIsIl9saWtlQ291bnRlciIsIl9jYXJkTGlrZSIsImxlbmd0aCIsIl9kZWxldGVCdXR0b24iLCJyZW1vdmVDYXJkIiwiZ2VuZXJhdGVDYXJkIiwiYXBpIiwiX2dldFJlc3BvbnNlRGF0YSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJFcnJvciIsInN0YXR1cyIsImdldFByb2ZpbGUiLCJmZXRjaCIsInVybCIsImhlYWRlcnMiLCJ0aGVuIiwiZ2V0Q2FyZHMiLCJlZGl0UHJvZmlsZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGRDYXJkIiwiaGFuZGxlQ29udHJvbExpa2VzIiwicmVxdWVzdCIsImNhcmRJZCIsImRlbGV0ZUNhcmQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiYWJvdXRVc2VyU2VsZWN0b3IiLCJ1c2VyU2VsZWN0b3IiLCJfYWJvdXRVc2VyIiwiX3VzZXJBdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiZ2V0VXNlcklkIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkc0RhdGEiLCJjYXJkTGlzdCIsInJlbmRlckl0ZW1zIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJjYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJwb3B1cFdpdGhEZWxldGlvbkNvbmZpcm1hdGlvbkZvcm0iLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImNhcmRzIiwiX2ltYWdlIiwiX3RpdGxlIiwicG9wdXBXaXRoQWRkUGhvdG9Gb3JtIiwiZmluYWxseSIsInBvcHVwV2l0aEVkaXRQcm9maWxlRm9ybSIsInBvcHVwV2l0aEVkaXRBdmF0YXJGb3JtIiwiY2FyZHNBZGRGb3JtVmFsaWRhdG9yIiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9