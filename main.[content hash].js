(()=>{"use strict";class e{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}_showError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),t.classList.add(this._config.errorClass),t.textContent=e.validationMessage}_hideError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}setButtonState(){this._toggleButtonState()}setInputValidity(){this._inputList.forEach((e=>{this._checkInputValidity(e)}))}setState(){this._toggleButtonState(),this.setInputValidity()}enableValidation(){this._setEventListeners()}}const t=document.querySelector("#button_edit"),s=document.querySelector("#button_add"),n=document.querySelector("#cardsAddForm"),i=document.querySelector("#profileEditForm"),r=(document.querySelector("#popup_photo"),{inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_visible"});class o{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton=this._popup.querySelector(".popup__close"),this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target===this._popup&&this.close()}))}}class a extends o{constructor(e,{callBack:t}){super(e),this._callBack=t,this._formElement=this._popup.querySelector(".form"),this._inputList=this._popup.querySelectorAll(".form__input"),this.setEventListeners()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._getInputValues()),this.close()}))}close(){super.close(),this._formElement&&"cardsAddForm"===this._formElement.id&&this._formElement.reset()}}class l{constructor(e,t,{handleCardClick:s}){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_setData(){this._cardImage=this._element.querySelector(".card__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName=this._element.querySelector(".card__title"),this._cardName.textContent=this._name}_deleteCard(){this._element.remove(),this._element=null}_likeCard(){this._like=this._element.querySelector(".card__like"),this._like.classList.toggle("card__like_active")}_setEventListeners(){this._deleteButton=this._element.querySelector(".card__delete"),this._deleteButton.addEventListener("click",(()=>{this._deleteCard()})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})})),this._cardLike=this._element.querySelector(".card__like"),this._cardLike.addEventListener("click",(()=>{this._likeCard()}))}generateCard(){return this._element=this._getTemplate(),this._setData(),this._setEventListeners(),this._element}}const c=new class extends o{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._title=this._popup.querySelector(".popup__title"),this.setEventListeners()}open(e){super.open(),this._image.src=e.link,this._image.alt=e.name,this._title.textContent=e.name}}("#popup_photo"),_=e=>{const t=new l(e,"#card-template",{handleCardClick:e=>{c.open(e)}}).generateCard();d.addItem(t)},d=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach(this._renderer)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{_(e)}},".places"),h=new a("#popup_add",{callBack:e=>{_(e)}}),u=new a("#popup_edit",{callBack:e=>{p.setUserInfo(e)}}),p=new class{constructor({nameSelector:e,aboutUserSelector:t}){this._name=document.querySelector(e),this._aboutUser=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,about:this._aboutUser.textContent}}setUserInfo(e){this._name.textContent=e.name,this._aboutUser.textContent=e.about}}({nameSelector:".profile__title",aboutUserSelector:".profile__subtitle"}),m=new e(r,n),E=new e(r,i);t.addEventListener("click",(()=>{const e=p.getUserInfo();u.setInputValues(e),u.open(),E.setState()})),s.addEventListener("click",(()=>{h.open(),m.setButtonState()})),d.renderItems(),E.enableValidation(),m.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZLGFBQUV1SCxFQUFZLGtCQUFFQyxJQUN4QnJILEtBQUswRSxNQUFRbkMsU0FBUzlCLGNBQWMyRyxHQUNwQ3BILEtBQUtzSCxXQUFhL0UsU0FBUzlCLGNBQWM0RyxFQUM3QyxDQUVBRSxjQUNJLE1BQU8sQ0FBRXZELEtBQU1oRSxLQUFLMEUsTUFBTXZELFlBQWFxRyxNQUFPeEgsS0FBS3NILFdBQVduRyxZQUNsRSxDQUVBZ0csWUFBYTVDLEdBQ1R2RSxLQUFLMEUsTUFBTXZELFlBQWNvRCxFQUFLUCxLQUM5QmhFLEtBQUtzSCxXQUFXbkcsWUFBY29ELEVBQUtpRCxLQUN2QyxHSGdDMEIsQ0FBQ0osYUFBYyxrQkFBbUJDLGtCQUFtQix1QkFDN0VJLEVBQXdCLElBQUk3SCxFQUFjK0MsRUFBa0JGLEdBQzVEaUYsRUFBMkIsSUFBSTlILEVBQWMrQyxFQUFrQkQsR0FFckVKLEVBQWtCTCxpQkFBaUIsU0FBUyxLQUN4QyxNQUFNa0MsRUFBYytDLEVBQVNLLGNBQzdCTixFQUF5Qi9DLGVBQWVDLEdBQ3hDOEMsRUFBeUJoRSxPQUN6QnlFLEVBQXlCdEYsVUFBVSxJQUd2Q0ksRUFBZVAsaUJBQWlCLFNBQVMsS0FDckMrRSxFQUFzQi9ELE9BQ3RCd0UsRUFBc0J2RixnQkFBZ0IsSUFHMUNtRSxFQUFTVSxjQUNUVyxFQUF5QnJGLG1CQUN6Qm9GLEVBQXNCcEYsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zaG93RXJyb3IoaW5wdXRFbGVtZW50KXtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUVycm9yKGlucHV0RWxlbWVudCl7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCl7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0Vycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKCl7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKXtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpe1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXRCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW5wdXRWYWxpZGl0eSgpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXRTdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpXHJcbiAgICAgICAgdGhpcy5zZXRJbnB1dFZhbGlkaXR5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpe1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9O1xyXG59IiwiZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2J1dHRvbl9lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBwaG90b0FkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNidXR0b25fYWRkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkc0FkZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZHNBZGRGb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlRWRpdEZvcm0nKTtcclxuZXhwb3J0IGNvbnN0IHBob3RvUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcG9wdXBfcGhvdG8nKTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gICAgaW5wdXRTZWxlY3RvcjogJy5mb3JtX19pbnB1dCcsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5mb3JtX19idXR0b24nLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogJ2Zvcm1fX2J1dHRvbl9pbmFjdGl2ZScsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6ICdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICAgIGVycm9yQ2xhc3M6ICdmb3JtX19pbnB1dC1lcnJvcl92aXNpYmxlJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAn0JDRgNGF0YvQtycsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9hcmtoeXouanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAn0KfQtdC70Y/QsdC40L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjCcsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9jaGVseWFiaW5zay1vYmxhc3QuanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAn0JjQstCw0L3QvtCy0L4nLFxyXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvaXZhbm92by5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICfQmtCw0LzRh9Cw0YLQutCwJyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2thbWNoYXRrYS5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICfQpdC+0LvQvNC+0LPQvtGA0YHQutC40Lkg0YDQsNC50L7QvScsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9raG9sbW9nb3Jza3ktcmF5b24uanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAn0JHQsNC50LrQsNC7JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2JhaWthbC5qcGcnXHJcbiAgICB9XHJcbl07IiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpe1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZScpO1xyXG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYoZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSIsImltcG9ydCB7UG9wdXB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHtjYWxsQmFja30pIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9jYWxsQmFjayA9IGNhbGxCYWNrO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faW5wdXQnKTtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCl7XHJcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSB7fTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgZm9ybURhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICByZXR1cm4gZm9ybURhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW5wdXRWYWx1ZXMoaW5wdXRWYWx1ZXMpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbGxCYWNrKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICBpZiAodGhpcy5fZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2Zvcm1FbGVtZW50LmlkID09PSAnY2FyZHNBZGRGb3JtJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCB7aGFuZGxlQ2FyZENsaWNrfSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXREYXRhKCkge1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5fY2FyZE5hbWUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpXHJcbiAgICAgICAgdGhpcy5fY2FyZE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIF9kZWxldGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgX2xpa2VDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2xpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlJyk7XHJcbiAgICAgICAgdGhpcy5fbGlrZS5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19saWtlX2FjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUnKTtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUNhcmQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9jYXJkTGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UnKTtcclxuICAgICAgICB0aGlzLl9jYXJkTGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUNhcmQoKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9zZXREYXRhKCk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG59XHJcbiIsImltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gICAgaW5pdGlhbENhcmRzLFxyXG4gICAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgICBwaG90b0FkZEJ1dHRvbixcclxuICAgIGNhcmRzQWRkRm9ybSxcclxuICAgIHByb2ZpbGVFZGl0Rm9ybVxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgJy4vaW5kZXguY3NzJ1xyXG5pbXBvcnQge1BvcHVwV2l0aEltYWdlfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQge0NhcmR9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcjcG9wdXBfcGhvdG8nKTtcclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoaXRlbSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGl0ZW0sICcjY2FyZC10ZW1wbGF0ZScsIHtcclxuICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbiAoe1xyXG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgIHJlbmRlckNhcmQoaXRlbSk7XHJcbiAgICB9XHJcbn0sICcucGxhY2VzJyk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhBZGRQaG90b0Zvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSgnI3BvcHVwX2FkZCcsIHtcclxuICAgIGNhbGxCYWNrOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgIHJlbmRlckNhcmQoaXRlbSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cF9lZGl0Jywge1xyXG4gICAgY2FsbEJhY2s6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe25hbWVTZWxlY3RvcjogJy5wcm9maWxlX190aXRsZScsIGFib3V0VXNlclNlbGVjdG9yOiAnLnByb2ZpbGVfX3N1YnRpdGxlJ30pO1xyXG5jb25zdCBjYXJkc0FkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBjYXJkc0FkZEZvcm0pO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBwb3B1cFdpdGhFZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXMoaW5wdXRWYWx1ZXMpO1xyXG4gICAgcG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtLm9wZW4oKTtcclxuICAgIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5zZXRTdGF0ZSgpO1xyXG59KTtcclxuXHJcbnBob3RvQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoQWRkUGhvdG9Gb3JtLm9wZW4oKTtcclxuICAgIGNhcmRzQWRkRm9ybVZhbGlkYXRvci5zZXRCdXR0b25TdGF0ZSgpO1xyXG59KVxyXG5cclxuY2FyZExpc3QucmVuZGVySXRlbXMoKTtcclxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuY2FyZHNBZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbiIsImltcG9ydCB7UG9wdXB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3RpdGxlJyk7XHJcbiAgICAgICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oZGF0YSkge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3Ipe1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKCl7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKVxyXG4gICAgfVxyXG59IiwiXHJcblxyXG5leHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGFib3V0VXNlclNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2Fib3V0VXNlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRVc2VyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvICgpIHtcclxuICAgICAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBhYm91dDogdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50IH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyAoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfc2hvd0Vycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRCdXR0b25TdGF0ZSIsInNldElucHV0VmFsaWRpdHkiLCJzZXRTdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicGhvdG9BZGRCdXR0b24iLCJjYXJkc0FkZEZvcm0iLCJwcm9maWxlRWRpdEZvcm0iLCJ2YWxpZGF0aW9uQ29uZmlnIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ1dHRvbiIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJjYWxsQmFjayIsInN1cGVyIiwiX2NhbGxCYWNrIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybURhdGEiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiQ2FyZCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsImxpbmsiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldERhdGEiLCJfY2FyZEltYWdlIiwiX2VsZW1lbnQiLCJzcmMiLCJhbHQiLCJfY2FyZE5hbWUiLCJfZGVsZXRlQ2FyZCIsIl9saWtlQ2FyZCIsIl9saWtlIiwidG9nZ2xlIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkTGlrZSIsImdlbmVyYXRlQ2FyZCIsInBvcHVwV2l0aEltYWdlIiwiX2ltYWdlIiwiX3RpdGxlIiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlZEl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJwb3B1cFdpdGhBZGRQaG90b0Zvcm0iLCJwb3B1cFdpdGhFZGl0UHJvZmlsZUZvcm0iLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiYWJvdXRVc2VyU2VsZWN0b3IiLCJfYWJvdXRVc2VyIiwiZ2V0VXNlckluZm8iLCJhYm91dCIsImNhcmRzQWRkRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=